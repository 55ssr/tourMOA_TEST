<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Notice">
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="noticeVO" type="tourMOA.service.NoticeVO"/>
	
	<insert id="noticeDAO.insertNotice">
		INSERT INTO notice 
			( unq
			  , gubun
			  , title
			  , content
			  , hit
			  , rdate
			  , all_view )
		VALUES ( SEQ_notice_unq.nextval
			  , #gubun#
			  , #title#
			  , #content#
			  , '0'
			  , sysdate
			  , #all_view# )
	</insert>
	
	<select id="noticeDAO.selectNoticeList" resultClass="egovMap">
		SELECT b.* FROM (
			SELECT 
				rownum rn, a.* FROM (
							SELECT	  unq
									, gubun
									, title
									, content
									, hit
									, rdate
									, DECODE(all_view,'Y',('사용'),('중지')) allview
									, upddate 
							FROM 
									notice
									
							WHERE
									1=1 
									
							<isNotNull property="searchCondition">
								<isNotEmpty property="searchCondition">
									AND $searchCondition$ LIKE '%' || #searchKeyword# || '%' 	
								</isNotEmpty>
							</isNotNull>		
									
							ORDER BY rdate DESC
									) a
						) b
		WHERE 
				rn >= #firstIndex# AND rn <![CDATA[<=]]> #lastIndex#
	</select>
	
	<select id="noticeDAO.selectNoticeTotal" resultClass="java.lang.Integer">
		SELECT COUNT(*) FROM notice
	</select>
	
</sqlMap>