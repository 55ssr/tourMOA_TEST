<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Category">

	<typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="categoryVO" type="tourMOA.service.CategoryVO"/>
	
	<!-- <insert id="categoryDAO.insertCategory">
		INSERT INTO category (
				ctgcd,
				ctgnm,
				comm,
				use,
				regdate,
				upddate
			) VALUES (
				#ctgcd#,
				#ctgnm#,
				#comm#,
				#use#,
				sysdate,
				sysdate
			)
	</insert> -->
	
	<select id="categoryDAO.selectCategoryList" resultClass="egovMap">
			SELECT 
				ctgcd,
				ctgnm,
				SUBSTR(SYS_CONNECT_BY_PATH(ctgnm, '>'),1) Path,
				use
	 		FROM  
	 			category 
	    	WHERE
    			1 = 1
    		<isNotNull property="srchContn">
    			<isNotNull property="srchKeywd">
	    			<isEqual property="srchContn" compareValue="hctgcd">
	    				AND hctgcd = #srchKeywd#
	    			</isEqual>
	    			<isEqual property="srchContn" compareValue="ctgnm">
	    				AND ctgnm LIKE '%' || #srchKeywd# || '%' 
	    			</isEqual>
	    			<isEqual property="srchContn" compareValue="use">
	    				AND use = #use#
	    			</isEqual>
	    		</isNotNull>
			</isNotNull>
			START WITH hctgcd = '0'
 			CONNECT BY PRIOR ctgcd=hctgcd
	</select>
</sqlMap>