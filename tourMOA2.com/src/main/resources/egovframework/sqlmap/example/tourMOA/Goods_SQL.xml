<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="GoodsSpace">

	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="goodsVO" type="tourMOA.service.GoodsVO"/>

	<select id="goodsDAO.selectGoodsList" resultClass="egovMap">
		SELECT b.* FROM (
			SELECT 
				rownum rn, a.* FROM (
							SELECT	  unq
									, gubun
									, title
									, location
									, nation
									, city
									, price
									, TO_CHAR(sdate, 'yyyy-mm-dd') sdate
									, TO_CHAR(edate, 'yyyy-mm-dd') edate
									, DECODE(use,'Y',('사용'),('중지')) use
									, rdate
							FROM 
									goods
									
							WHERE
									1=1 
									
							<isNotNull property="searchCondition">
								<isNotEmpty property="searchCondition">
									AND $searchCondition$ LIKE '%' || #searchKeyword# || '%' 	
								</isNotEmpty>
							</isNotNull>		
									
							ORDER BY rdate DESC
									) a
						) b
		WHERE 
				rn >= #firstIndex# AND rn <![CDATA[<=]]> #lastIndex#
	</select>
	
	<select id="goodsDAO.selectGoodsTotal" resultClass="java.lang.Integer">
		SELECT COUNT(*) FROM goods
	</select>
	
	<insert id="goodsDAO.insertGoods">
		INSERT INTO goods (	unq,
							title,
							gubun,
							location,
							nation,
							city,
							price,
							pricech,
							pricein,
							sdate,
							edate,
							period,
							period1,
							period2,
							via,
							vias,
							use,
							schd,
							detail1,
							detail2,
							airline,
							person,
							code,
							rdate
							) 
		VALUES (SEQ_goods_unq.nextval,
				'$title$',
				'$gubun$',
				'$location$',
				'$nation$',
				'$city$',
				'$price$',
				'$pricech$',
				'$pricein$',
				'$sdate$',
				'$edate$',
				'$period$',
				'$period1$',
				'$period2$',
				'$via$',
				'$vias$',
				'$use$',
				'$schd$',
				'$detail1$',
				'$detail2$',
				'$airline$',
				'$person$',
				'$code$',
				sysdate
				)
	</insert>
	
	<select id="goodsDAO.selectGoodsDetail" resultClass="goodsVO">
		SELECT 
				unq,
				title,
				gubun,
				location,
				nation,
				city,
				price,
				pricech,
				pricein,
				sdate,
				edate,
				period,
				period1,
				period2,
				via,
				vias,
				use,
				schd,
				detail1,
				detail2,
				airline,
				person,
				code
		FROM
			goods
		WHERE
			unq = '$unq$'
	</select>
	
	<update id="goodsDAO.updateGoods">
		UPDATE goods SET 
					title = '$title$'
					, gubun = '$gubun$'
					, location = '$location$'
					, nation = '$nation$'
					, city = '$city$'
					, price = '$price$'
					, pricech = '$pricech$'
					, pricein = '$pricein$'
					, sdate = '$sdate$'
					, edate = '$edate$'
					, period = '$period$'
					, period1 = '$period1$'
					, period2 = '$period2$'
					, via = '$via$'
					, vias = '$vias$'
					, use = '$use$'
					, schd = '$schd$'
					, detail1 = '$detail1$'
					, detail2 = '$detail2$'
					, airline = '$airline$'
					, person = '$person$'
					, code = '$code$'
		WHERE unq = '$unq$'
	</update>
	
	<delete id="goodsDAO.deleteGoods">
		DELETE FROM goods WHERE unq = '$unq$'
	</delete>
	
</sqlMap>















